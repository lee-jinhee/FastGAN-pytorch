from get_dataset import get_predefined_dataset
from torchvision import utils as vutils
from torchvision import transforms
import torch
from torch.utils.data.dataloader import DataLoader
from torch.utils.data import Subset
import matplotlib.pyplot as plt
from PIL import Image
import random

dataset = get_predefined_dataset('cifar10', './dataset/cifar10/')
im_size = 1024

selected_idx_list= [31637, 32166, 11233, 13896, 28838, 11917, 2365, 4012, 42639, 36903, 39473, 33305, 28885, 30659, 5770, 13921, 21418, 30013, 36489, 48207, 44614, 4016, 25677, 25984, 2803, 13857, 47668, 3703, 12996, 41234, 40919, 18167, 43438, 46277, 13254, 16665, 7888, 29103, 8768, 49153, 10194, 37160, 15057, 31455, 45460, 43006, 17650, 17699, 47172, 36236, 41939, 23249, 15312, 41716, 18960, 36410, 11904, 20468, 38424, 28480, 14641, 43795, 27903, 26462, 49697, 45609, 3312, 33741, 45492, 4832, 31741, 54, 39378, 315, 20065, 45795, 39399, 9031, 22338, 10374, 10883, 15333, 43263, 16470, 6032, 43886, 19837, 2599, 45559, 12060, 6581, 16914, 27908, 40556, 16288, 7780, 15567, 18178, 5411, 23469, 7567, 43192, 27735, 11339, 23851, 33465, 507, 20216, 18635, 16496, 17898, 47840, 6462, 15807, 34821, 45182, 36796, 16887, 19566, 13628, 34642, 25580, 16768, 34926, 37265, 19383, 40230, 12836, 30146, 36738, 9982, 11354, 34170, 28246, 4139, 26351, 4234, 8071, 10247, 47316, 45948, 197, 43105, 12517, 27504, 5218, 30537, 48794, 9817, 41273, 39008, 31347, 20701, 13777, 38731, 39113, 46801, 17776, 48303, 13085, 2747, 41221, 48025, 12284, 10623, 27984, 36106, 48598, 267, 49773, 48865, 37797, 45180, 26007, 22185, 20200, 46085, 1010, 4974, 29593, 14364, 24605, 46969, 8106, 3808, 21780, 30211, 25398, 22733, 11178, 37391, 40575, 44276, 42194, 13446, 26765, 33638, 27751, 27300, 30204, 31016, 37901, 9259, 11515, 33393, 5076, 33890, 12371, 982, 40668, 34789, 31503, 25821, 23402, 43982, 33975, 33259, 1119, 38087, 15920, 11095, 29478, 28935, 6530, 47024, 41214, 6427, 48882, 23693, 42914, 10549, 28641, 23201, 2789, 28238, 37315, 37919, 23343, 28443, 32423, 38102, 17691, 3362, 21668, 36608, 41333, 29413, 6557, 12818, 45632, 22324, 45898, 42181, 49853, 29684, 23157, 30413, 37398, 28323, 33187, 6210, 33504, 39905, 5557, 39282, 48910, 15551, 32227, 18193, 13277, 29968, 35581, 8801, 730, 32744, 34693, 29871, 30291, 17067, 18199, 37887, 28029, 25125, 41559, 16424, 31183, 38100, 31405, 21074, 33178, 16876, 33616, 9892, 33618, 43829, 34740, 35872, 3870, 27397, 46943, 6019, 48966, 43017, 11144, 34031, 15954, 49673, 39553, 43407, 10989, 30708, 2822, 861, 2578, 19961, 43219, 42023, 23803, 4748, 13398, 17714, 25670, 19024, 21513, 39829, 44911, 37903, 16110, 10111, 7573, 3224, 12908, 13650, 30490, 7046, 40830, 47565, 45513, 31536, 40322, 40992, 27289, 28083, 23918, 12465, 7574, 16633, 3874, 231, 8755, 38256, 33303, 47112, 11825, 39269, 32812, 6151, 13527, 35904, 4062, 2036, 11007, 10011, 13410, 2457, 35171, 18387, 1671, 8183, 45884, 3855, 1610, 19756, 7850, 6548, 6922, 22216, 17259, 13945, 24634, 12430, 38337, 44439, 47249, 13413, 10499, 14195, 33776, 36447, 10765, 25726, 6018, 4679, 27347, 17868, 5699, 6932, 18174, 19187, 12058, 26703, 34373, 40497, 10819, 11811, 47457, 42169, 38126, 18997, 41535, 14627, 49742, 2326, 6828, 43289, 16339, 44432, 14309, 8240, 14239, 1023, 42792, 47523, 1710, 27093, 34996, 30196, 36933, 45892, 16804, 7511, 33125, 31836, 38008, 47084, 26720, 8861, 40961, 7757, 2598, 47813, 40362, 7803, 47265, 34433, 18922, 23830, 48354, 37109, 46942, 38001, 33545, 37082, 870, 7719, 43716, 27046, 14494, 49293, 18285, 17477, 47732, 4378, 45663, 47063, 30295, 38209, 40941, 15836, 36290, 40843, 6482, 31844, 14718, 32511, 9844, 24668, 1472, 21991, 33095, 4308, 25843, 15325, 3451, 174, 39428, 36216, 49450, 11397, 9328, 18687, 9861, 3965, 41802, 42498, 44374, 47882, 25900, 34956, 38014, 697, 13717, 22747, 20720, 36615, 42746, 48611, 46286, 48103, 33550, 24058, 10910, 21363, 38448, 31835, 1222, 10321, 27328, 16246, 45422, 12966, 43286, 42766, 35882, 28849, 40649, 32038, 32036, 19373, 15767, 25830, 36976, 42563, 39775, 34700, 37163, 14504, 5658, 45363, 41010, 32139, 40593, 15456, 27086, 24909, 9299, 14888, 367, 26948, 25754, 19337, 15647, 41425, 16579, 46971, 20495, 34904, 37378, 48384, 15301, 4267, 26731, 14125, 13004, 6190, 36573, 7974, 14346, 26097, 8153, 36696, 29018, 20929, 9889, 45459, 24757, 40626, 23276, 32078, 16438, 17199, 6456, 24112, 48953, 1273, 11969, 11540, 27632, 45783, 24815, 18210, 36563, 32704, 37516, 20512, 45117, 40134, 42829, 35993, 14539, 39392, 11596, 859, 46123, 34541, 10187, 46281, 7858, 27824, 37982, 34733, 39089, 12552, 30356, 36056, 30277, 10982, 25438, 7823, 39529, 29414, 29787, 21115, 41767, 1486, 41658, 14327, 20960, 33128, 3373, 23281, 14311, 42415, 36180, 2809, 19844, 20757, 38886, 5434, 12945, 24866, 49276, 19887, 23438, 493, 36294, 10956, 43792, 41179, 46838, 38718, 24743, 40227, 46060, 30927, 39375, 6368, 33032, 19835, 45342, 33538, 292, 24372, 23990, 32466, 22874, 21534, 24568, 9714, 35513, 40721, 10384, 37732, 9485, 31751, 22726, 49536, 1492, 45170, 45725, 31340, 37704, 37152, 34935, 32950, 45737, 12618, 19118, 15029, 47306, 45532, 27726, 14174, 19401, 44112, 38225, 2289, 44995, 4756, 33435, 43533, 24423, 16021, 40720, 40511, 12532, 3192, 11495, 34716, 49656, 32359, 28031, 35222, 28912, 31901, 10324, 23168, 27587, 13289, 46506, 893, 13649, 4887, 38729, 24801, 22723, 20577, 30833, 34601, 42940, 30346, 26499, 20629, 1039, 5392, 48093, 40834, 31159, 44821, 15206, 44233, 47866, 32314, 3748, 36974, 14296, 19850, 5368, 27207, 15097, 41845, 14950, 15032, 44823, 27064, 31384, 44576, 14176, 31680, 38628, 14642, 4826, 9134, 32106, 8396, 36353, 40543, 26602, 47688, 1958, 15459, 31907, 17024, 25212, 22913, 43675, 46598, 46464, 41526, 33998, 39235, 13627, 27705, 16839, 45681, 34146, 29090, 7937, 43846, 20141, 39344, 33899, 16060, 1359, 14423, 35541, 34654, 20464, 39052, 45010, 27472, 44748, 9527, 3226, 8251, 29580, 25084, 32241, 4824, 22411, 41589, 7734, 7543, 9107, 25515, 5540, 22358, 14632, 49408, 2117, 3660, 40794, 8481, 26883, 32873, 48261, 27356, 30038, 40365, 23763, 23421, 41485, 32072, 39770, 1320, 11805, 28307, 37643, 33209, 12928, 28162, 32045, 41104, 31411, 4061, 1759, 36274, 16662, 17430, 9517, 5514, 30896, 14137, 42817, 35463, 17473, 24510, 13346, 37697, 42543, 33617, 32678, 33702, 18077, 47479, 27522, 42105, 1468, 41218, 7452, 25681, 42209, 23352, 45288, 37696, 21606, 23023, 36528, 40526, 13100, 241, 39645, 5458, 4380, 15806, 2550, 7956, 14087, 45249, 19437, 33570, 41105, 31704, 25464, 46655, 2681, 33361, 5016, 1976, 27685, 19245, 16238, 37661, 21054, 43483, 22642, 33659, 3916, 43507, 44104, 8225, 16002, 32863, 13392, 35832, 1002, 18796, 8209, 13834, 6614, 32972, 44857, 9005, 14145, 28015, 27750, 24208, 11963, 22012, 3909, 18479, 12736, 7171, 28518, 34396, 46223, 1990, 22184, 10604, 12290, 1499, 14077, 1722, 38940, 18819, 17013, 36949, 29807, 36927, 17262, 16349, 1482, 48927, 21686, 14812, 46493, 46443, 37208, 4322, 13963, 46367, 44856, 19558, 41650, 46369, 31550, 9298, 44172, 15225, 17753, 4172, 18086, 35679, 4447, 26064, 36843, 33983, 41770, 36398, 46551, 8784, 29021, 34492, 5323, 34457, 46196, 46933, 10357, 4091, 9741, 734, 5715, 47899, 24704, 46290, 35764, 20393, 7843, 15317, 42573]
selected_idx_list = list(random.sample(selected_idx_list,100))

random_idx_list = list(random.sample(range(len(dataset)),100))

selected_subset = Subset(dataset, selected_idx_list)
random_subset = Subset(dataset, random_idx_list)

subset_dict = {'selected':selected_subset, 'random':random_subset}
for key, subset in subset_dict.items():
    loader = DataLoader(subset, batch_size = 100, shuffle= False)
    data_iter = iter(loader)
    images, labels = data_iter.next()
    image_grid = vutils.make_grid(images.add(1).mul(0.5), nrow=10)#.permute(1,2,0)
    vutils.save_image(image_grid, f'./{key}_cifar10_images.png')
    #plt.imshow(image_grid.numpy())
    #print(image_grid)
    #plt.savefig(f'./{key}_cifar10_plt.png')
    #plt.clf()